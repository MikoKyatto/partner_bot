"""
Configuration settings for Lethai Concierge Referral Bot
"""
import os
from typing import List, Dict, Any
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

class Config:
    """Bot configuration class"""
    
    # Bot settings
    BOT_TOKEN: str = os.getenv('BOT_TOKEN', '')
    BOT_NAME: str = "Lethai Concierge Referral Bot"
    BOT_VERSION: str = "1.0.0"
    
    # Admin settings
    ADMIN_USER_ID: int = int(os.getenv('ADMIN_USER_ID', '1454702347'))
    ADMIN_GROUP_ID: str = os.getenv('ADMIN_GROUP_ID', '-1003016595712')
    
    # Google Sheets settings
    SHEETS_ID: str = os.getenv('SHEETS_ID', '18dY652fOqEJ6EC1ppMlMF0Obzlzu32xxVXt5AJ9415A')
    SHEET_NAME: str = 'Ð›Ð¸ÑÑ‚1'
    CREDENTIALS_PATH: str = os.getenv('CREDENTIALS_PATH', 'credentials.json')
    
    # Database settings
    DATABASE_PATH: str = 'users.db'
    
    # Referral settings
    REFERRAL_BASE_URL: str = 'https://taplink.cc/lakeevainfo'
    SUPPORT_USERNAME: str = '@LakeevaaaThai'
    
    # QR Code settings
    QR_SIZE: int = 400
    IMAGE_SIZE: int = 512
    BACKGROUND_COLOR: str = '#1A3C34'
    TEXT_COLOR: str = '#FFFFFF'
    FONT_SIZE: int = 40
    
    # Rate limiting
    RATE_LIMIT_MESSAGES: int = 10
    RATE_LIMIT_PERIOD: int = 60  # seconds
    
    # Logging
    LOG_LEVEL: str = os.getenv('LOG_LEVEL', 'INFO')
    LOG_FILE: str = 'bot.log'
    
    # Development settings
    DEBUG: bool = os.getenv('DEBUG', 'False').lower() == 'true'
    TESTING: bool = os.getenv('TESTING', 'False').lower() == 'true'
    
    # Validation settings
    MIN_NAME_LENGTH: int = 2
    MAX_NAME_LENGTH: int = 50
    MIN_PHONE_LENGTH: int = 10
    MAX_PHONE_LENGTH: int = 20
    
    # Message templates
    MESSAGES: Dict[str, str] = {
        'welcome': (
            "ðŸï¸ Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Lethai!\n\n"
            "Ð”Ð»Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð´ÐµÐ»Ð¸Ñ‚ÐµÑÑŒ ÑÐ²Ð¾Ð¸Ð¼ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð¼, Ð½Ð°Ð¶Ð°Ð² ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð½Ð¸Ð¶Ðµ:"
        ),
        'contact_request': "ðŸ“± ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð¼",
        'name_request': "ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾! Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÐµ Ð¸Ð¼Ñ:",
        'registration_success': (
            "âœ… Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°!\n\n"
            "ÐžÐ¶Ð¸Ð´Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ Ð² Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ.\n"
            "ÐœÑ‹ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð¸Ð¼ Ð²Ð°Ñ, ÐºÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð°."
        ),
        'approval_waiting': (
            "ÐžÐ¶Ð¸Ð´Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ Ð² Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ.\n"
            "ÐœÑ‹ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð¸Ð¼ Ð²Ð°Ñ, ÐºÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð°."
        ),
        'approval_success': (
            "ðŸŽ‰ ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÐµÐ¼! Ð’Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½Ð°!\n\n"
            "Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Lethai.\n"
            "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /start Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð¼ÐµÐ½ÑŽ."
        ),
        'approval_rejected': (
            "âŒ Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ð²Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð±Ñ‹Ð»Ð° Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð°.\n\n"
            "ÐŸÐ¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼ Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ Ð² Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÑƒ: @LakeevaaaThai"
        ),
        'main_menu': (
            "Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Lethai! ðŸï¸\n\n"
            "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¸Ð· Ð¼ÐµÐ½ÑŽ Ð½Ð¸Ð¶Ðµ:"
        ),
        'referral_link': (
            "ðŸ”— Ð’Ð°ÑˆÐ° Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ°:\n\n{link}\n\n"
            "ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÐµÑÑŒ ÑÑ‚Ð¾Ð¹ ÑÑÑ‹Ð»ÐºÐ¾Ð¹ Ñ Ð´Ñ€ÑƒÐ·ÑŒÑÐ¼Ð¸ Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ð¹Ñ‚Ðµ Ð±Ð¾Ð½ÑƒÑÑ‹ Ð·Ð° ÐºÐ°Ð¶Ð´ÑƒÑŽ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ! ðŸŽ\n\n"
            "ðŸ’¡ ÐšÐ°Ðº ÑÑ‚Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚:\n"
            "â€¢ ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÐµÑÑŒ ÑÑÑ‹Ð»ÐºÐ¾Ð¹ Ñ Ð´Ñ€ÑƒÐ·ÑŒÑÐ¼Ð¸\n"
            "â€¢ ÐžÐ½Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾ Ð²Ð°ÑˆÐµÐ¹ ÑÑÑ‹Ð»ÐºÐµ\n"
            "â€¢ Ð’Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚Ðµ Ð±Ð¾Ð½ÑƒÑ Ð·Ð° ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»Ð°\n"
            "â€¢ Ð‘Ð°Ð»Ð°Ð½Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸"
        ),
        'balance_info': (
            "ðŸ’° Ð’Ð°Ñˆ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð±Ð°Ð»Ð°Ð½Ñ: {balance:.2f} â‚½\n\n"
            "ðŸ“Š Ð‘Ð°Ð»Ð°Ð½Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¸ Ð¿Ð¾ÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ð¸ Ð½Ð¾Ð²Ñ‹Ñ… Ñ€ÐµÑ„ÐµÑ€Ð°Ð»Ð¾Ð².\n"
            "ðŸ’¬ ÐŸÐ¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ Ðº @LakeevaaaThai"
        ),
        'support_info': (
            "ðŸ†˜ ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Lethai\n\n"
            "ÐŸÐ¾ Ð²ÑÐµÐ¼ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼ Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ Ðº Ð½Ð°ÑˆÐµÐ¼Ñƒ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñƒ:\n"
            "@LakeevaaaThai\n\n"
            "ÐœÑ‹ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÐ¼ Ð²Ð°Ð¼ Ñ Ð»ÑŽÐ±Ñ‹Ð¼Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼Ð¸ Ð¿Ð¾ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ðµ! ðŸ’¬\n\n"
            "â° Ð’Ñ€ÐµÐ¼Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð°: Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ 1-2 Ñ‡Ð°ÑÐ¾Ð² Ð² Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ"
        ),
        'error_generic': "ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ Ð¸Ð»Ð¸ Ð¾Ð±Ñ€Ð°Ñ‚Ð¸Ñ‚ÐµÑÑŒ Ð² Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÑƒ.",
        'error_balance': "ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ Ð±Ð°Ð»Ð°Ð½ÑÐ°, Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.",
        'error_qr': "ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÑÑ‹Ð»ÐºÐ¸. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.",
        'error_database': "ÐžÑˆÐ¸Ð±ÐºÐ° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.",
        'error_sheets': "ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Google Sheets. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.",
    }
    
    # Keyboard layouts
    KEYBOARDS: Dict[str, List[List[str]]] = {
        'main_menu': [
            ["ÐœÐ¾Ñ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ°"],
            ["ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ"],
            ["ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°"]
        ],
        'contact_share': [
            ["ðŸ“± ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð¼"]
        ]
    }
    
    # Validation patterns
    PATTERNS: Dict[str, str] = {
        'phone': r'^\+?[1-9]\d{1,14}$',
        'name': r'^[a-zA-ZÐ°-ÑÐ-Ð¯Ñ‘Ð\s\-\.]{2,50}$',
        'telegram_id': r'^\d+$'
    }
    
    # Error messages
    ERRORS: Dict[str, str] = {
        'invalid_name': "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ðµ Ð¸Ð¼Ñ (Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°):",
        'name_too_long': "Ð˜Ð¼Ñ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð»Ð¸Ð½Ð½Ð¾Ðµ. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð´Ð¾ 50 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²:",
        'invalid_phone': "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð½Ð¾Ð¼ÐµÑ€ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ðµ Ñ€Ð°Ð·:",
        'contact_required': "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð´ÐµÐ»Ð¸Ñ‚ÐµÑÑŒ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð¼, Ð½Ð°Ð¶Ð°Ð² ÐºÐ½Ð¾Ð¿ÐºÑƒ:",
        'not_admin': "âŒ Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð² Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°.",
        'user_not_found': "âŒ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½.",
        'user_already_approved': "âŒ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑƒÐ¶Ðµ Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½.",
        'sheets_connection_failed': "âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Google Sheets.",
        'database_error': "âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ….",
    }
    
    @classmethod
    def validate(cls) -> List[str]:
        """Validate configuration and return list of errors"""
        errors = []
        
        if not cls.BOT_TOKEN:
            errors.append("BOT_TOKEN is required")
        
        if not cls.SHEETS_ID:
            errors.append("SHEETS_ID is required")
        
        if not cls.ADMIN_USER_ID:
            errors.append("ADMIN_USER_ID is required")
        
        if not cls.ADMIN_GROUP_ID:
            errors.append("ADMIN_GROUP_ID is required")
        
        return errors
    
    @classmethod
    def get_referral_link(cls, partnercode: str) -> str:
        """Generate referral link for partner code"""
        return f"{cls.REFERRAL_BASE_URL}?ref={partnercode}"
    
    @classmethod
    def get_support_link(cls) -> str:
        """Get support contact link"""
        return f"https://t.me/{cls.SUPPORT_USERNAME.replace('@', '')}"
    
    @classmethod
    def is_admin(cls, user_id: int) -> bool:
        """Check if user is admin"""
        return user_id == cls.ADMIN_USER_ID

# Create global config instance
config = Config()

# Validate configuration on import
if __name__ == "__main__":
    errors = config.validate()
    if errors:
        print("Configuration errors:")
        for error in errors:
            print(f"  - {error}")
    else:
        print("Configuration is valid")

